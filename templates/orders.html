{% extends "base.html" %}

{% block title %}Orders - Clubinho Bookstore{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-7xl">
    <!-- Page Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-white mb-2">Orders Management</h1>
        <p class="text-gray-400">Track and manage all customer orders and quotes</p>
    </div>

    <!-- Tab Navigation -->
    <div class="mb-6">
        <div class="flex gap-3 border-b border-white/20">
            <button id="orders-tab" class="tab-btn active px-6 py-3 font-semibold text-white border-b-2 border-primary transition-all" onclick="switchTab('orders')">
                <i class="fas fa-box mr-2"></i>Orders
            </button>
            <button id="quotes-tab" class="tab-btn px-6 py-3 font-semibold text-gray-400 border-b-2 border-transparent hover:text-white hover:border-white/30 transition-all" onclick="switchTab('quotes')">
                <i class="fas fa-file-invoice mr-2"></i>Pending Quotes
            </button>
        </div>
    </div>

    <!-- Orders Section -->
    <div id="orders-section">
    <!-- Search and Add Section -->
    <div class="mb-6 grid grid-cols-1 md:grid-cols-12 gap-3">
        <div class="md:col-span-8">
            <label for="searchInput" class="sr-only">Search orders and customers</label>
            <input type="text"
                   id="searchInput"
                   class="w-full bg-background-card border-2 border-white/20 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/30 transition-all"
                   placeholder="Search orders, customers..."
                   aria-label="Search orders and customers"
                   onkeyup="searchOrders()">
        </div>
        <div class="md:col-span-4">
            <button class="w-full bg-gradient-to-r from-primary to-primary-dark text-white font-semibold py-3 rounded-lg hover:shadow-lg hover:scale-105 transition-all duration-200"
                    data-bs-toggle="modal"
                    data-bs-target="#orderModal"
                    onclick="openAddModal()"
                    aria-label="Add new order">
                <i class="fas fa-plus mr-2" aria-hidden="true"></i>Add Order
            </button>
        </div>
    </div>

    <!-- Quick Filter Section -->
    <div class="mb-6 flex items-center gap-3 flex-wrap">
        <span class="text-gray-400 font-semibold">QUICK FILTER:</span>
        <button class="filter-btn active px-4 py-2 rounded-lg font-semibold transition-all"
                onclick="filterOrders('all')"
                data-filter="all">
            <i class="fas fa-list mr-2"></i>All
        </button>
        <button class="filter-btn px-4 py-2 rounded-lg font-semibold transition-all"
                onclick="filterOrders('processing')"
                data-filter="processing">
            <i class="fas fa-sync-alt mr-2"></i>Processing
        </button>
        <button class="filter-btn px-4 py-2 rounded-lg font-semibold transition-all"
                onclick="filterOrders('delivered')"
                data-filter="delivered">
            <i class="fas fa-check-circle mr-2"></i>Delivered
        </button>
    </div>

    <!-- Floating Batch Controls Bar -->
    <div class="hidden fixed top-0 left-0 right-0 bg-background-card/95 backdrop-blur-lg border-b-4 border-primary p-6 shadow-2xl z-50"
         id="batchControls"
         style="animation: slideDown 0.3s ease-out;">
        <div class="container mx-auto flex justify-between items-center flex-wrap gap-4">
            <div class="flex items-center gap-3 font-bold text-lg">
                <i class="fas fa-check-circle text-primary"></i>
                <span id="selectedCount" class="text-primary">0</span>
                <span class="text-white">orders selected</span>
            </div>
            <div class="flex gap-3 flex-wrap">
                <button type="button"
                        class="bg-gradient-to-r from-primary to-primary-dark text-white font-semibold px-6 py-2 rounded-lg hover:shadow-lg transition-all"
                        id="batchEditBtn">
                    <i class="fas fa-edit mr-2"></i>Batch Edit
                </button>
                <button type="button"
                        class="bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold px-6 py-2 rounded-lg hover:shadow-lg transition-all"
                        id="batchDeleteBtn">
                    <i class="fas fa-trash mr-2"></i>Batch Delete
                </button>
                <button type="button"
                        class="bg-gradient-to-r from-secondary to-secondary-dark text-white font-semibold px-6 py-2 rounded-lg hover:shadow-lg transition-all"
                        id="clearSelectionBtn">
                    <i class="fas fa-times mr-2"></i>Clear Selection
                </button>
            </div>
        </div>
    </div>

    <!-- Orders List -->
    <div class="grid grid-cols-1 gap-6">
        {% if orders %}
            {% for order in orders %}
            <div class="order-card bg-background-card rounded-xl shadow-lg border border-white/10 overflow-hidden transition-all hover:border-primary/50 hover:shadow-2xl"
                 data-search-text="{{ order.customer_name|lower }} {{ order.asset_name|lower }} {{ order.payment_type|lower }}">

                <!-- Order Header -->
                <div class="p-6 bg-gradient-to-r from-primary/10 to-secondary/10 border-b border-white/10">
                    <div class="flex items-start gap-4">
                        <!-- Checkbox -->
                        <div class="flex items-center pt-1">
                            <input type="checkbox"
                                   class="w-5 h-5 rounded border-white/30 bg-background-hover text-primary focus:ring-2 focus:ring-primary/30 cursor-pointer order-select-checkbox"
                                   data-order-id="{{ order.order_id }}"
                                   data-customer-name="{{ order.customer_name }}"
                                   data-current-delivery-date="{{ order.delivery_date or '' }}"
                                   data-current-payment-type="{{ order.payment_type or '' }}">
                        </div>

                        <!-- Order Info -->
                        <div class="flex-1">
                            <div class="text-sm text-primary font-semibold mb-1">Order #{{ order.order_id }}</div>
                            <div class="text-xl font-bold text-white mb-1">{{ order.asset_name or 'Unknown Asset' }}</div>
                            <div class="text-gray-300 flex items-center gap-2">
                                <i class="fas fa-user text-primary"></i>
                                {{ order.customer_name or 'Unknown Customer' }}
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex gap-2">
                            <button class="w-10 h-10 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-lg transition-all flex items-center justify-center"
                                    aria-label="Edit order #{{ order.order_id }} for {{ order.customer_name }}"
                                    title="Edit Order"
                                    data-bs-toggle="modal"
                                    data-bs-target="#orderModal"
                                    onclick="editOrder({{ order.order_id }}, '{{ order.customer_name }}', '{{ order.asset_name }}', '{{ order.order_date }}', {{ order.order_real or 0 }}, {{ order.order_ien or 0 }}, {{ order.frete_brasil or 0 }}, {{ order.frete_jp or 0 }}, {{ order.total_value or 0 }}, '{{ order.delivery_date or '' }}', '{{ order.payment_type or '' }}')">
                                <i class="fas fa-edit" aria-hidden="true"></i>
                            </button>
                            <button class="w-10 h-10 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg transition-all flex items-center justify-center"
                                    aria-label="Delete order #{{ order.order_id }} for {{ order.customer_name }}"
                                    title="Delete Order"
                                    onclick="deleteOrder({{ order.order_id }}, '{{ order.customer_name }}')">
                                <i class="fas fa-trash" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Order Details -->
                <div class="p-6 space-y-3">
                    <div class="flex items-center gap-2 text-gray-300">
                        <i class="fas fa-calendar text-primary w-5"></i>
                        <span class="font-semibold">Order Date:</span>
                        <span>{{ order.order_date.strftime('%Y/%m/%d') if order.order_date else 'N/A' }}</span>
                    </div>

                    {% if order.delivery_date %}
                    <div class="flex items-center gap-2 text-gray-300">
                        <i class="fas fa-truck text-primary w-5"></i>
                        <span class="font-semibold">Delivery:</span>
                        <span>{{ order.delivery_date.strftime('%Y/%m/%d') if order.delivery_date else 'N/A' }}</span>
                    </div>
                    {% endif %}

                    {% if order.payment_type %}
                    <div class="flex items-center gap-2 text-gray-300">
                        <i class="fas fa-credit-card text-primary w-5"></i>
                        <span class="font-semibold">Payment:</span>
                        <span>{{ order.payment_type }}</span>
                    </div>
                    {% endif %}

                    <div class="flex items-center gap-2 text-gray-300">
                        <i class="fas fa-plus text-primary w-5"></i>
                        <span class="font-semibold">Created:</span>
                        <span>{{ order.created_at.strftime('%Y/%m/%d %H:%M') if order.created_at else 'N/A' }}</span>
                    </div>
                </div>

                <!-- Financial Details -->
                <div class="p-6 bg-background-hover/50 border-t border-white/10">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="text-center">
                            <div class="text-xl font-bold text-green-400">R$ {{ "{:,.2f}".format(order.order_real) if order.order_real else '0.00' }}</div>
                            <div class="text-xs text-gray-400 mt-1">Real Value</div>
                        </div>
                        <div class="text-center">
                            <div class="text-xl font-bold text-yellow-400">¬•{{ "{:,.0f}".format(order.order_ien) if order.order_ien else '0' }}</div>
                            <div class="text-xs text-gray-400 mt-1">Yen Value</div>
                        </div>
                        <div class="text-center">
                            <div class="text-xl font-bold text-blue-400">R$ {{ "{:,.2f}".format(order.frete_brasil) if order.frete_brasil else '0.00' }}</div>
                            <div class="text-xs text-gray-400 mt-1">Brazil Shipping</div>
                        </div>
                        <div class="text-center">
                            <div class="text-xl font-bold text-blue-400">¬•{{ "{:,.0f}".format(order.frete_jp) if order.frete_jp else '0' }}</div>
                            <div class="text-xs text-gray-400 mt-1">Japan Shipping</div>
                        </div>
                    </div>
                </div>

                <!-- Total Value & Status -->
                <div class="p-6 bg-gradient-to-r from-primary/20 to-secondary/20 border-t border-white/10">
                    <div class="flex items-center justify-between flex-wrap gap-4">
                        <div class="flex items-center gap-2 text-white">
                            <i class="fas fa-calculator text-primary"></i>
                            <span class="font-semibold">Total:</span>
                            <span class="text-2xl font-bold">¬•{{ "{:,.0f}".format(order.total_value) if order.total_value else '0' }}</span>
                        </div>

                        <div>
                            {% if order.delivery_date %}
                                <span class="inline-flex items-center gap-2 bg-green-500/20 text-green-400 px-4 py-2 rounded-full font-semibold">
                                    <i class="fas fa-check-circle"></i> Delivered
                                </span>
                            {% elif order.order_date %}
                                <span class="inline-flex items-center gap-2 bg-blue-500/20 text-blue-400 px-4 py-2 rounded-full font-semibold">
                                    <i class="fas fa-sync-alt"></i> Processing
                                </span>
                            {% else %}
                                <span class="inline-flex items-center gap-2 bg-yellow-500/20 text-yellow-400 px-4 py-2 rounded-full font-semibold">
                                    <i class="fas fa-clock"></i> Pending
                                </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}

            <!-- Pagination -->
            {% if total_pages > 1 %}
            <div class="mt-8">
                <nav class="flex justify-center">
                    <ul class="flex items-center gap-2">
                        {% if has_prev %}
                        <li>
                            <a href="{{ url_for('orders', page=page-1) }}"
                               class="w-10 h-10 flex items-center justify-center bg-background-card text-white rounded-lg hover:bg-primary hover:scale-110 transition-all">
                                <i class="fas fa-chevron-left"></i>
                            </a>
                        </li>
                        {% endif %}

                        {% for p in range(1, total_pages + 1) %}
                            {% if p == page %}
                            <li>
                                <span class="w-10 h-10 flex items-center justify-center bg-gradient-to-r from-primary to-primary-dark text-white rounded-lg font-bold shadow-lg">
                                    {{ p }}
                                </span>
                            </li>
                            {% elif p <= 3 or p >= total_pages - 2 or (p >= page - 1 and p <= page + 1) %}
                            <li>
                                <a href="{{ url_for('orders', page=p) }}"
                                   class="w-10 h-10 flex items-center justify-center bg-background-card text-white rounded-lg hover:bg-primary hover:scale-110 transition-all">
                                    {{ p }}
                                </a>
                            </li>
                            {% elif p == 4 and page > 6 %}
                            <li>
                                <span class="w-10 h-10 flex items-center justify-center text-gray-400">...</span>
                            </li>
                            {% elif p == total_pages - 3 and page < total_pages - 5 %}
                            <li>
                                <span class="w-10 h-10 flex items-center justify-center text-gray-400">...</span>
                            </li>
                            {% endif %}
                        {% endfor %}

                        {% if has_next %}
                        <li>
                            <a href="{{ url_for('orders', page=page+1) }}"
                               class="w-10 h-10 flex items-center justify-center bg-background-card text-white rounded-lg hover:bg-primary hover:scale-110 transition-all">
                                <i class="fas fa-chevron-right"></i>
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                </nav>
            </div>
            {% endif %}

        {% else %}
            <!-- Empty State -->
            <div class="text-center py-20">
                <div class="text-8xl text-primary/20 mb-6">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <h3 class="text-2xl font-bold text-white mb-3">No Orders Yet</h3>
                <p class="text-gray-400 mb-6">Start by creating your first quote or order!</p>
                <div class="flex gap-3 justify-center">
                    <button class="bg-gradient-to-r from-secondary to-secondary-dark text-white font-semibold px-6 py-3 rounded-lg hover:shadow-lg hover:scale-105 transition-all"
                            onclick="switchToCalculator()">
                        <i class="fas fa-calculator mr-2"></i>Create Quote
                    </button>
                    <button class="bg-gradient-to-r from-primary to-primary-dark text-white font-semibold px-6 py-3 rounded-lg hover:shadow-lg hover:scale-105 transition-all"
                            data-bs-toggle="modal"
                            data-bs-target="#orderModal"
                            onclick="openAddModal()">
                        <i class="fas fa-plus mr-2"></i>Add Order
                    </button>
                </div>
            </div>
        {% endif %}
    </div>
    </div>
    <!-- End Orders Section -->

    <!-- Quotes Section -->
    <div id="quotes-section" class="hidden">
        <div class="mb-6">
            <p class="text-gray-400">Review and approve pending quotes to convert them to orders</p>
        </div>

        <!-- Quotes List Container -->
        <div id="quotes-list" class="grid grid-cols-1 gap-6">
            <!-- Quotes will be loaded here by quotes.js -->
            <div class="text-center py-12">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3 text-gray-400">Loading quotes...</p>
            </div>
        </div>
    </div>
    <!-- End Quotes Section -->
</div>

<!-- Modals -->
{% include 'partials/order_modals.html' %}

<style>
@keyframes slideDown {
    from {
        transform: translateY(-100%);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

@keyframes slideUp {
    from {
        transform: translateY(0);
        opacity: 1;
    }
    to {
        transform: translateY(-100%);
        opacity: 0;
    }
}

.batch-controls.hide {
    animation: slideUp 0.3s ease-out forwards;
}

/* Quick Filter Buttons */
.filter-btn {
    background: rgb(63, 63, 63);
    color: rgb(156, 163, 175);
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.filter-btn:hover {
    background: rgb(74, 74, 74);
    border-color: rgba(255, 149, 0, 0.5);
    transform: translateY(-2px);
}

.filter-btn.active {
    background: linear-gradient(to right, rgb(255, 149, 0), rgb(255, 117, 0));
    color: white;
    border-color: rgb(255, 149, 0);
    box-shadow: 0 4px 15px rgba(255, 149, 0, 0.3);
}

/* Tab Navigation Styles */
.tab-btn {
    cursor: pointer;
}

.tab-btn.active {
    color: white;
    border-bottom-color: rgb(255, 149, 0);
}

/* Quote Cards Styles */
.quote-card {
    background: rgb(63, 63, 63);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 24px;
    transition: all 0.3s;
}

.quote-card:hover {
    border-color: rgba(255, 149, 0, 0.5);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
}

.quote-header {
    display: flex;
    justify-content: space-between;
    align-items: start;
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.quote-info h5 {
    color: white;
    font-size: 1.25rem;
    font-weight: bold;
    margin-bottom: 8px;
}

.quote-info p {
    color: rgb(156, 163, 175);
    margin: 4px 0;
}

.quote-actions {
    display: flex;
    gap: 12px;
}

.btn-approve-quote {
    background: linear-gradient(to right, rgb(34, 197, 94), rgb(22, 163, 74));
    color: white;
    font-weight: 600;
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-approve-quote:hover {
    box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
    transform: scale(1.05);
}

.btn-reject-quote {
    background: linear-gradient(to right, rgb(239, 68, 68), rgb(220, 38, 38));
    color: white;
    font-weight: 600;
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-reject-quote:hover {
    box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
    transform: scale(1.05);
}

.quote-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 12px;
}

.quote-detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
}

.quote-detail-label {
    color: rgb(156, 163, 175);
    font-size: 0.875rem;
}

.quote-detail-value {
    color: white;
    font-weight: 600;
}

.empty-quotes {
    text-align: center;
    padding: 80px 20px;
    color: rgb(156, 163, 175);
}

.empty-quotes i {
    font-size: 5rem;
    color: rgba(255, 149, 0, 0.2);
    margin-bottom: 20px;
}

.empty-quotes h4 {
    color: white;
    font-size: 1.5rem;
    margin-bottom: 12px;
}

.empty-quotes p {
    margin-bottom: 24px;
}

.empty-quotes button {
    background: linear-gradient(to right, rgb(255, 149, 0), rgb(255, 117, 0));
    color: white;
    font-weight: 600;
    padding: 12px 24px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: all 0.2s;
}

.empty-quotes button:hover {
    box-shadow: 0 4px 15px rgba(255, 149, 0, 0.4);
    transform: scale(1.05);
}
</style>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/orders.js') }}"></script>
<script src="{{ url_for('static', filename='js/calculator.js') }}"></script>
<script src="{{ url_for('static', filename='js/quotes.js') }}"></script>

<script>
// Tab switching functionality
function switchTab(tabName) {
    console.log('üîÑ Switching to tab:', tabName);

    // Get tab buttons
    const ordersTab = document.getElementById('orders-tab');
    const quotesTab = document.getElementById('quotes-tab');

    // Get sections
    const ordersSection = document.getElementById('orders-section');
    const quotesSection = document.getElementById('quotes-section');

    if (tabName === 'orders') {
        // Show orders, hide quotes
        ordersSection.classList.remove('hidden');
        quotesSection.classList.add('hidden');

        // Update tab buttons
        ordersTab.classList.add('active');
        ordersTab.classList.remove('text-gray-400');
        ordersTab.classList.add('text-white', 'border-primary');
        ordersTab.classList.remove('border-transparent');

        quotesTab.classList.remove('active');
        quotesTab.classList.add('text-gray-400');
        quotesTab.classList.remove('text-white', 'border-primary');
        quotesTab.classList.add('border-transparent');

        console.log('‚úÖ Switched to Orders tab');
    } else if (tabName === 'quotes') {
        // Show quotes, hide orders
        ordersSection.classList.add('hidden');
        quotesSection.classList.remove('hidden');

        // Update tab buttons
        quotesTab.classList.add('active');
        quotesTab.classList.remove('text-gray-400');
        quotesTab.classList.add('text-white', 'border-primary');
        quotesTab.classList.remove('border-transparent');

        ordersTab.classList.remove('active');
        ordersTab.classList.add('text-gray-400');
        ordersTab.classList.remove('text-white', 'border-primary');
        ordersTab.classList.add('border-transparent');

        console.log('‚úÖ Switched to Quotes tab');

        // Load quotes when switching to quotes tab
        if (typeof quotesManager !== 'undefined') {
            setTimeout(() => {
                quotesManager.loadQuotes();
            }, 100);
        } else {
            console.warn('‚ö†Ô∏è quotesManager not initialized yet');
        }
    }
}

// Helper function to switch to orders tab (used by quotes.js after approval)
function switchToOrders() {
    switchTab('orders');
}

// Helper function to navigate to calculator page
function switchToCalculator() {
    window.location.href = '/create_order';
}

// Helper function to refresh orders data (used by quotes.js after approval)
window.refreshOrdersData = function() {
    console.log('üîÑ Refreshing orders data...');
    // Reload the page to show the new order
    window.location.reload();
};

// Check if page loaded with hash to switch to quotes tab
document.addEventListener('DOMContentLoaded', () => {
    if (window.location.hash === '#quotes') {
        switchTab('quotes');
    }

    // Check if we just approved a quote and should highlight the new order
    const newOrderId = sessionStorage.getItem('newOrderId');
    if (newOrderId) {
        console.log('üéØ Highlighting newly created order:', newOrderId);

        // Clear the sessionStorage flag
        sessionStorage.removeItem('newOrderId');

        // Find the order card with this ID
        setTimeout(() => {
            const orderCards = document.querySelectorAll('.order-card');
            let foundOrder = false;

            orderCards.forEach(card => {
                const orderIdElement = card.querySelector('[data-order-id]');
                if (orderIdElement && orderIdElement.dataset.orderId === newOrderId) {
                    // Highlight the card
                    card.style.border = '3px solid rgb(255, 149, 0)';
                    card.style.boxShadow = '0 8px 30px rgba(255, 149, 0, 0.5)';

                    // Scroll to the card
                    card.scrollIntoView({ behavior: 'smooth', block: 'center' });

                    // Add a pulsing animation
                    card.style.animation = 'pulse 2s ease-in-out 3';

                    foundOrder = true;

                    // Remove highlight after 10 seconds
                    setTimeout(() => {
                        card.style.border = '';
                        card.style.boxShadow = '';
                        card.style.animation = '';
                    }, 10000);
                }
            });

            if (!foundOrder) {
                console.warn('‚ö†Ô∏è Could not find order card for ID:', newOrderId);
                // Show a general success message instead
                alert('Order #' + newOrderId + ' was created successfully! It should appear in the orders list.');
            } else {
                // Show success notification
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(to right, rgb(34, 197, 94), rgb(22, 163, 74));
                    color: white;
                    padding: 16px 24px;
                    border-radius: 8px;
                    box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
                    z-index: 9999;
                    font-weight: 600;
                `;
                notification.innerHTML = `<i class="fas fa-check-circle mr-2"></i>Order #${newOrderId} created successfully!`;
                document.body.appendChild(notification);

                // Remove notification after 5 seconds
                setTimeout(() => {
                    notification.style.transition = 'opacity 0.5s';
                    notification.style.opacity = '0';
                    setTimeout(() => notification.remove(), 500);
                }, 5000);
            }
        }, 500);
    }
});
</script>
{% endblock %}

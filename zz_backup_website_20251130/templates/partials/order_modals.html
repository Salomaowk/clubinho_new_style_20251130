<!-- Add/Edit Order Modal -->
<div class="modal fade" id="orderModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="orderModalTitle">
                    <i class="fas fa-plus me-2"></i>Add New Order
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="POST" id="orderForm">
                <div class="modal-body">
                    <input type="hidden" name="action" id="orderAction" value="add">
                    <input type="hidden" name="order_id" id="orderIdInput">
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Customer Name *</label>
                                <input type="text" class="form-control" name="customer_name" id="orderCustomerName" list="customersList" required>
                                <datalist id="customersList">
                                    {% for customer in customers %}
                                        <option value="{{ customer }}">
                                    {% endfor %}
                                </datalist>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Asset/Book *</label>
                                <input type="text" class="form-control" name="asset_name" id="orderAssetName" list="assetsList" required>
                                <datalist id="assetsList">
                                    {% for asset in assets %}
                                        <option value="{{ asset }}">
                                    {% endfor %}
                                </datalist>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Order Date *</label>
                                <input type="date" class="form-control" name="order_date" id="orderDate" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Delivery Date</label>
                                <input type="date" class="form-control" name="delivery_date" id="deliveryDate">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Order Real (R$)</label>
                                <input type="number" class="form-control" name="order_real" id="orderReal" step="0.01" min="0">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Order Yen (¥)</label>
                                <input type="number" class="form-control" name="order_ien" id="orderIen" step="1" min="0">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Freight Brazil (R$)</label>
                                <input type="number" class="form-control" name="frete_brasil" id="freteBrasil" step="0.01" min="0">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Freight Japan (¥)</label>
                                <input type="number" class="form-control" name="frete_jp" id="freteJp" step="1" min="0">
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Total Value (¥) *</label>
                                <input type="number" class="form-control" name="total_value" id="totalValue" step="1" min="0" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Payment Type</label>
                                <select class="form-control" name="payment_type" id="paymentType">
                                    <option value="">Select Payment Type</option>
                                    <option value="Cash">Cash</option>
                                    <option value="Credit Card">Credit Card</option>
                                    <option value="Bank Transfer">Bank Transfer</option>
                                    <option value="PayPal">PayPal</option>
                                    <option value="Quote Approved">Quote Approved</option>
                                    <option value="Pending">Pending</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="orderSubmitBtn">
                        <i class="fas fa-save me-2"></i>Save Order
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Order Modal -->
<div class="modal fade" id="deleteOrderModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-danger">
                    <i class="fas fa-exclamation-triangle me-2"></i>Delete Order
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="POST" id="deleteOrderForm">
                <div class="modal-body">
                    <input type="hidden" name="action" value="delete">
                    <input type="hidden" name="order_id" id="deleteOrderId">
                    
                    <div class="alert alert-warning">
                        <strong>Warning!</strong> This action cannot be undone.
                    </div>
                    
                    <p>Are you sure you want to delete the order for <strong id="deleteOrderCustomer"></strong>?</p>
                    
                    <div class="order-details" id="deleteOrderDetails">
                        <!-- Order details will be populated by JavaScript -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">
                        <i class="fas fa-trash me-2"></i>Delete Order
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Batch Edit Modal -->
<div class="modal fade" id="batchEditModal" tabindex="-1" aria-labelledby="batchEditModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header sticky-top" style="background: var(--gradient-header); z-index: 101;">
                <h5 class="modal-title" id="batchEditModalLabel">
                    <i class="fas fa-edit me-2"></i>Batch Edit Orders
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="POST" action="{{ url_for('batch_edit_orders') }}" id="batchEditForm">
                <div class="modal-body">
                    <input type="hidden" name="action" value="batch_edit">
                    <input type="hidden" name="order_ids" id="batchOrderIds">

                    <div class="alert alert-info" id="batchEditAlert" style="position: sticky; top: 0; z-index: 102; margin-bottom: 1rem;">
                        <i class="fas fa-info-circle me-2"></i>
                        You are editing <span id="batchOrderCount">0</span> orders
                    </div>

                    <div class="form-group mb-3">
                        <label class="form-label">Delivery Date</label>
                        <input type="date" class="form-control" name="delivery_date" id="batchDeliveryDate">
                        <small class="form-text text-muted">Leave empty to keep current dates</small>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Payment Type</label>
                        <select class="form-control" name="payment_type" id="batchPaymentType">
                            <option value="">Keep current payment types</option>
                            <option value="Cash">Cash</option>
                            <option value="Credit Card">Credit Card</option>
                            <option value="Bank Transfer">Bank Transfer</option>
                            <option value="PayPal">PayPal</option>
                            <option value="Quote Approved">Quote Approved</option>
                            <option value="Pending">Pending</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer sticky-bottom" style="background: var(--card-bg); border-top: 1px solid var(--border); z-index: 101;">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Update Orders
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>